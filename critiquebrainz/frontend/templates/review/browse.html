{% extends 'base.html' %}
{% from 'macros.html' import cover_art, review_credit with context %}

{% block title %}{{ _('Reviews') }} - CritiqueBrainz{% endblock %}

{% block content %}
<h2>{{ _('Reviews') }}</h2>
<form method="GET" action="{{ url_for('review.browse') }}">
  <div class="form-group" style="display: inline-block;">
    <select class="form-control input-sm" name="entity_type" onchange="this.form.submit()"> 
      <option value="None">{{ _('All') }}</option>
      <option value="release_group" {% if entity_type == 'release_group' %} selected {% endif %}>{{ _('Release group') }}</option>
      <option value="event" {% if entity_type == 'event' %} selected {% endif %}>{{ _('Event') }}</option>
      <option value="place" {% if entity_type == 'place' %} selected {% endif %}>{{ _('Place') }}</option>
    </select>
  </div>
</form>
<p><em class="text-muted">{{ _('Ordered by creation date') }}</em></p>

<div id="reviews-browse" class="row">
  {% for review in reviews %}
    {% set entity = entities[review.entity_id] %}
    <div class="col-md-4 review">
      <div class="cover-art-container pull-left">
        <a href="{{ url_for('review.entity', id=review.id) }}">
          {{ cover_art(entity.id, review.entity_type, overlay_type=True) }}
        </a>
      </div>
      <div class="album">{% include 'entity_review.html' %}</div>
      <div class="reviewer">
        <p>
          {{ review_credit(review, user_picture_size=16) }}
          <br/>
          {{ review.created | date }}
        </p>
      </div>
    </div>
  {% endfor %}
</div>

{% if count > limit %}
  <div class="col-md-12">
    <ul class="pager">
      {% if page > 1 %}
        <li class="previous"><a href="{{ url_for('review.browse', page=page-1) }}">&larr; {{ _('Previous') }}</a></li>
      {% endif %}
      {% if page-1 < count//limit %}
        <li class="next"><a href="{{ url_for('review.browse', page=page+1) }}">{{ _('Next') }} &rarr;</a></li>
      {% endif %}
    </ul>
  </div>
{% endif %}

{% endblock %}
